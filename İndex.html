<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Namaz Vakti Yardımcısı</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            touch-action: manipulation;
        }
        .action-button {
            transition: transform 0.1s ease-in-out, box-shadow 0.1s ease-in-out;
        }
        .action-button:active {
            transform: scale(0.98);
        }
    </style>
</head>
<body class="bg-gray-100 text-gray-800 flex items-center justify-center min-h-screen">

    <div id="app-container" class="w-full max-w-md mx-auto p-4">

        <!-- Main Menu Screen -->
        <div id="main-menu" class="space-y-4">
            <h1 class="text-4xl font-bold text-center text-teal-700 mb-6">Namaz Vakitleri</h1>
            <button data-prayer="sabah" class="action-button w-full bg-teal-500 text-white py-6 px-4 rounded-xl shadow-lg text-2xl font-bold">Sabah</button>
            <button data-prayer="ogle" class="action-button w-full bg-teal-500 text-white py-6 px-4 rounded-xl shadow-lg text-2xl font-bold">Öğle</button>
            <button data-prayer="ikindi" class="action-button w-full bg-teal-500 text-white py-6 px-4 rounded-xl shadow-lg text-2xl font-bold">İkindi</button>
            <button data-prayer="aksam" class="action-button w-full bg-teal-500 text-white py-6 px-4 rounded-xl shadow-lg text-2xl font-bold">Akşam</button>
            <button data-prayer="yatsi" class="action-button w-full bg-teal-500 text-white py-6 px-4 rounded-xl shadow-lg text-2xl font-bold">Yatsı</button>
        </div>

        <!-- Prayer Screen (Initially Hidden) -->
        <div id="prayer-screen" class="hidden">
            <h2 id="prayer-title" class="text-3xl font-bold text-center text-teal-700 mb-2"></h2>
            <p id="prayer-section" class="text-xl text-center text-gray-500 mb-4"></p>
            <div class="bg-white p-8 rounded-2xl shadow-xl text-center min-h-[200px] flex items-center justify-center">
                <p id="step-title" class="text-4xl font-semibold"></p>
            </div>
            <div class="mt-6 grid grid-cols-2 gap-4">
                 <button id="play-pause-btn" class="action-button w-full bg-green-600 text-white py-4 rounded-xl shadow-md text-xl font-bold">Başlat</button>
                 <button id="stop-btn" class="action-button w-full bg-red-500 text-white py-4 rounded-xl shadow-md text-xl font-bold">Durdur</button>
            </div>
        </div>
    </div>

    <audio id="audio-player"></audio>

    <script>
        // --- 1. AUDIO DATEIEN: IHRE MP3-LISTE ---
        // Alle Pfade gehen davon aus, dass die Dateien in einem "audio/" Ordner liegen.
        const audioFiles = {
            ezan: "audio/ezan.mp3",
            kamet: "audio/kamet.mp3",
            fatiha: "audio/fatiha.mp3",
            tekbir: "audio/tekbir.mp3",
            tekbir_subhaneke: "audio/tekbir_subhaneke.mp3",
            ruku: "audio/ruku.mp3",
            secde: "audio/secde.mp3",
            tahiyyat: "audio/tahiyyat.mp3",
            salli_barik: "audio/salli_barik.mp3",
            rabbena: "audio/rabbena.mp3",
            selam: "audio/selam.mp3",
            kunut: "audio/kunut.mp3",
            kalkis: "audio/kalkis.mp3",
            kalkis_rekat: "audio/kalkis_rekat.mp3",
            bitis: "audio/bitis.mp3",

            // Zammı Sureler
            zammisure_felak: "audio/zammisure_felak.mp3",
            zammisure_fil: "audio/zammisure_fil.mp3",
            zammisure_ihlas: "audio/zammisure_ihlas.mp3",
            zammisure_kevser: "audio/zammisure_kevser.mp3",
            zammisure_kureys: "audio/zammisure_kureys.mp3",
            zammisure_nas: "audio/zammisure_nas.mp3",

            // Sabah
            sabah_sunnet_niyet: "audio/sabah_sunnet_niyet.mp3",
            sabah_farz_gecis: "audio/sabah_farz_gecis.mp3",
            sabah_farz_niyet: "audio/sabah_farz_niyet.mp3",
            sabah_bitis: "audio/sabah_bitis.mp3",

            // Öğle
            oegle_ilksunnet_niyet: "audio/oegle_ilksunnet_niyet.mp3",
            oegle_farz_gecis: "audio/oegle_farz_gecis.mp3",
            oegle_farz_niyet: "audio/oegle_farz_niyet.mp3",
            oegle_sonsunnet_gecis: "audio/oegle_sonsunnet_gecis.mp3",
            oegle_sonsunnet_niyet: "audio/oegle_sonsunnet_niyet.mp3",
            oegle_bitis: "audio/oegle_bitis.mp3",

            // İkindi
            ikindi_sunnet_niyet: "audio/ikindi_sunnet_niyet.mp3",
            ikindi_farz_gecis: "audio/ikindi_farz_gecis.mp3",
            ikindi_farz_niyet: "audio/ikindi_farz_niyet.mp3",
            ikindi_bitis: "audio/ikindi_bitis.mp3",

            // Akşam
            aksam_farz_niyet: "audio/aksam_farz_niyet.mp3",
            aksam_sunnet_gecis: "audio/akşam_sunnet_gecis.mp3",
            aksam_sunnet_niyet: "audio/aksam_sünet_niyet.mp3",
            aksam_bitis: "audio/aksam_bitis.mp3",

            // Yatsı
            yatsi_ilksunnet_niyet: "audio/yatsi_ilksunnet_niyet.mp3",
            yatsi_farz_gecis: "audio/yatsi_farz_gecis.mp3",
            yatsi_farz_niyet: "audio/yatsi_farz_niyet.mp3",
            yatsi_sonsunnet_gecis: "audio/yatsi_sonsunnet_gecis.mp3",
            yatsi_sonsunnet_niyet: "audio/yatsi_sonsunnet_niyet.mp3",
            yatsi_vitir_niyet: "audio/yatsi_vitir_niyet.mp3",
            yatsi_bitis: "audio/yatsi_bitis.mp3",
        };

        const zammisureKeys = Object.keys(audioFiles).filter(k => k.startsWith('zammisure_'));

        // --- 2. GEBETSABLAUF (DETAILLIERT) ---
        
        // Bausteine für eine Rekat (Gebetseinheit)
        const rekat_1 = [
            { title: "Tekbir & Sübhaneke", audioKey: "tekbir_subhaneke" },
            { title: "Fatiha", audioKey: "fatiha" },
            { title: "Zammı Sure", audioKey: "ZAMMISURE_RANDOM" },
            { title: "Rüku", audioKey: "ruku" },
            { title: "Secde", audioKey: "secde" },
            { title: "Kalkış", audioKey: "kalkis_rekat" },
        ];
        const rekat_2_otur = [ // 2. Rekat mit Sitzen (Tahiyyat)
            { title: "Fatiha", audioKey: "fatiha" },
            { title: "Zammı Sure", audioKey: "ZAMMISURE_RANDOM" },
            { title: "Rüku", audioKey: "ruku" },
            { title: "Secde", audioKey: "secde" },
            { title: "Tahiyyat", audioKey: "tahiyyat" },
        ];
        const rekat_3_kalk = [ // 3. Rekat mit Aufstehen
             { title: "Kalkış", audioKey: "kalkis" },
             { title: "Fatiha", audioKey: "fatiha" },
             { title: "Rüku", audioKey: "ruku" },
             { title: "Secde", audioKey: "secde" },
             { title: "Kalkış", audioKey: "kalkis_rekat" },
        ];
        const rekat_son_selam = [ // Letzte Rekat mit Salli-Barik, Rabbena, Selam
            { title: "Fatiha", audioKey: "fatiha" },
            { title: "Rüku", audioKey: "ruku" },
            { title: "Secde", audioKey: "secde" },
            { title: "Tahiyyat", audioKey: "tahiyyat" },
            { title: "Salli-Barik", audioKey: "salli_barik" },
            { title: "Rabbena", audioKey: "rabbena" },
            { title: "Selam", audioKey: "selam" },
        ];
        const vitir_rekat_3 = [ // Spezielle 3. Rekat für Vitir-Gebet
             { title: "Kalkış", audioKey: "kalkis" },
             { title: "Fatiha", audioKey: "fatiha" },
             { title: "Zammı Sure", audioKey: "ZAMMISURE_RANDOM" },
             { title: "Kunut Duaları", audioKey: "kunut"},
             { title: "Rüku", audioKey: "ruku" },
             { title: "Secde", audioKey: "secde" },
             { title: "Tahiyyat", audioKey: "tahiyyat" },
             { title: "Salli-Barik", audioKey: "salli_barik" },
             { title: "Rabbena", audioKey: "rabbena" },
             { title: "Selam", audioKey: "selam" },
        ];


        const prayerData = {
            sabah: {
                name: "Sabah Namazı",
                steps: [
                    { section: "Başlangıç", title: "Ezan", audioKey: "ezan" },
                    // Sünnet (2 Rekat)
                    { section: "Sünnet", title: "Niyet", audioKey: "sabah_sunnet_niyet" },
                    ...rekat_1,
                    ...rekat_2_otur,
                    { section: "Sünnet", title: "Salli-Barik", audioKey: "salli_barik" },
                    { section: "Sünnet", title: "Rabbena", audioKey: "rabbena" },
                    { section: "Sünnet", title: "Selam", audioKey: "selam" },
                    // Farz (2 Rekat)
                    { section: "Farz", title: "Geçiş & Kamet", audioKey: "sabah_farz_gecis" },
                    { section: "Farz", title: "Niyet", audioKey: "sabah_farz_niyet" },
                    ...rekat_1,
                    ...rekat_2_otur,
                    { section: "Farz", title: "Salli-Barik", audioKey: "salli_barik" },
                    { section: "Farz", title: "Rabbena", audioKey: "rabbena" },
                    { section: "Farz", title: "Selam", audioKey: "selam" },
                    { section: "Bitiş", title: "Tesbihat", audioKey: "sabah_bitis" },
                ]
            },
            ogle: {
                name: "Öğle Namazı",
                steps: [
                    { section: "Başlangıç", title: "Ezan", audioKey: "ezan" },
                    // İlk Sünnet (4 Rekat)
                    { section: "İlk Sünnet", title: "Niyet", audioKey: "oegle_ilksunnet_niyet" },
                    ...rekat_1,
                    ...rekat_2_otur,
                    ...rekat_3_kalk,
                    ...rekat_son_selam,
                    // Farz (4 Rekat)
                    { section: "Farz", title: "Geçiş & Kamet", audioKey: "oegle_farz_gecis" },
                    { section: "Farz", title: "Niyet", audioKey: "oegle_farz_niyet" },
                    ...rekat_1,
                    ...rekat_2_otur,
                    ...rekat_3_kalk,
                    ...rekat_son_selam,
                    // Son Sünnet (2 Rekat)
                    { section: "Son Sünnet", title: "Geçiş", audioKey: "oegle_sonsunnet_gecis" },
                    { section: "Son Sünnet", title: "Niyet", audioKey: "oegle_sonsunnet_niyet" },
                     ...rekat_1,
                    ...rekat_2_otur,
                    { section: "Son Sünnet", title: "Salli-Barik", audioKey: "salli_barik" },
                    { section: "Son Sünnet", title: "Rabbena", audioKey: "rabbena" },
                    { section: "Son Sünnet", title: "Selam", audioKey: "selam" },
                    { section: "Bitiş", title: "Tesbihat", audioKey: "oegle_bitis" },
                ]
            },
            ikindi: {
                name: "İkindi Namazı",
                steps: [
                     { section: "Başlangıç", title: "Ezan", audioKey: "ezan" },
                    // Sünnet (4 Rekat)
                    { section: "Sünnet", title: "Niyet", audioKey: "ikindi_sunnet_niyet" },
                    ...rekat_1,
                    ...rekat_2_otur,
                    { section: "Sünnet", title: "Salli-Barik", audioKey: "salli_barik" }, // Sünnette 2. rekatta salli-barik okunur
                    ...rekat_3_kalk,
                    ...rekat_son_selam,
                    // Farz (4 Rekat)
                    { section: "Farz", title: "Geçiş & Kamet", audioKey: "ikindi_farz_gecis" },
                    { section: "Farz", title: "Niyet", audioKey: "ikindi_farz_niyet" },
                    ...rekat_1,
                    ...rekat_2_otur,
                    ...rekat_3_kalk,
                    ...rekat_son_selam,
                    { section: "Bitiş", title: "Tesbihat", audioKey: "ikindi_bitis" },
                ]
            },
            aksam: {
                name: "Akşam Namazı",
                steps: [
                    { section: "Başlangıç", title: "Ezan", audioKey: "ezan" },
                     // Farz (3 Rekat)
                    { section: "Farz", title: "Kamet & Niyet", audioKey: "aksam_farz_niyet" },
                    ...rekat_1,
                    ...rekat_2_otur,
                    ...rekat_son_selam, // 3. Rekat burada son rekat oluyor
                    // Sünnet (2 Rekat)
                    { section: "Sünnet", title: "Geçiş", audioKey: "aksam_sunnet_gecis" },
                    { section: "Sünnet", title: "Niyet", audioKey: "aksam_sunnet_niyet" },
                    ...rekat_1,
                    ...rekat_2_otur,
                    { section: "Sünnet", title: "Salli-Barik", audioKey: "salli_barik" },
                    { section: "Sünnet", title: "Rabbena", audioKey: "rabbena" },
                    { section: "Sünnet", title: "Selam", audioKey: "selam" },
                    { section: "Bitiş", title: "Tesbihat", audioKey: "aksam_bitis" },
                ]
            },
            yatsi: {
                name: "Yatsı Namazı",
                steps: [
                    { section: "Başlangıç", title: "Ezan", audioKey: "ezan" },
                    // İlk Sünnet (4 Rekat)
                    { section: "İlk Sünnet", title: "Niyet", audioKey: "yatsi_ilksunnet_niyet" },
                    ...rekat_1,
                    ...rekat_2_otur,
                    { section: "İlk Sünnet", title: "Salli-Barik", audioKey: "salli_barik" },
                    ...rekat_3_kalk,
                    ...rekat_son_selam,
                    // Farz (4 Rekat)
                    { section: "Farz", title: "Geçiş & Kamet", audioKey: "yatsi_farz_gecis" },
                    { section: "Farz", title: "Niyet", audioKey: "yatsi_farz_niyet" },
                    ...rekat_1,
                    ...rekat_2_otur,
                    ...rekat_3_kalk,
                    ...rekat_son_selam,
                    // Son Sünnet (2 Rekat)
                    { section: "Son Sünnet", title: "Geçiş", audioKey: "yatsi_sonsunnet_gecis" },
                    { section: "Son Sünnet", title: "Niyet", audioKey: "yatsi_sonsunnet_niyet" },
                    ...rekat_1,
                    ...rekat_2_otur,
                    { section: "Son Sünnet", title: "Salli-Barik", audioKey: "salli_barik" },
                    { section: "Son Sünnet", title: "Rabbena", audioKey: "rabbena" },
                    { section: "Son Sünnet", title: "Selam", audioKey: "selam" },
                    // Vitir (3 Rekat)
                    { section: "Vitir", title: "Niyet", audioKey: "yatsi_vitir_niyet" },
                    ...rekat_1,
                    ...rekat_2_otur,
                    ...vitir_rekat_3,
                    { section: "Bitiş", title: "Tesbihat", audioKey: "yatsi_bitis" },
                ]
            }
        };

        // --- 3. APP LOGIK ---
        let currentPrayer = null;
        let currentStepIndex = 0;
        let isPlaying = false;

        const mainMenu = document.getElementById('main-menu');
        const prayerScreen = document.getElementById('prayer-screen');
        const prayerTitle = document.getElementById('prayer-title');
        const prayerSection = document.getElementById('prayer-section');
        const stepTitle = document.getElementById('step-title');
        const audioPlayer = document.getElementById('audio-player');
        const playPauseBtn = document.getElementById('play-pause-btn');
        const stopBtn = document.getElementById('stop-btn');

        function getAudioPath(step) {
            let audioKey = step.audioKey;
            if (audioKey === "ZAMMISURE_RANDOM") {
                // Wähle eine zufällige Sure
                const randomIndex = Math.floor(Math.random() * zammisureKeys.length);
                audioKey = zammisureKeys[randomIndex];
                console.log("Zufällige Sure gewählt:", audioKey);
            }
            return audioFiles[audioKey];
        }

        function playCurrentStep() {
            const prayer = prayerData[currentPrayer];
            if (currentStepIndex >= prayer.steps.length) {
                showMainMenu();
                return;
            }
            const step = prayer.steps[currentStepIndex];
            const audioPath = getAudioPath(step);
            
            prayerSection.textContent = step.section;
            stepTitle.textContent = step.title;
            
            if (!audioPath) {
                console.log("Keine Audiodatei, gehe zum nächsten Schritt.");
                goToNextStep();
                return;
            }

            console.log(`Spiele Audio ab: ${audioPath}`);
            // --- Diesen Block einkommentieren, um die Audio-Wiedergabe zu aktivieren ---
            
            try {
                audioPlayer.src = audioPath;
                audioPlayer.play().catch(e => console.error("Audio-Wiedergabe fehlgeschlagen:", e));
                isPlaying = true;
                playPauseBtn.textContent = "Duraklat"; // Pause
            } catch (error) {
                console.error("Fehler beim Setzen der Audioquelle:", error);
            }
            
        }
        
        function goToNextStep() {
            currentStepIndex++;
            playCurrentStep();
        }

        function startPrayer(prayerKey) {
            currentPrayer = prayerKey;
            currentStepIndex = 0;
            mainMenu.classList.add('hidden');
            prayerScreen.classList.remove('hidden');
            
            const prayer = prayerData[currentPrayer];
            prayerTitle.textContent = prayer.name;
            prayerSection.textContent = prayer.steps[0].section;
            stepTitle.textContent = prayer.steps[0].title;
            playPauseBtn.textContent = "Başlat"; // Start
            isPlaying = false;
        }

        function showMainMenu() {
            prayerScreen.classList.add('hidden');
            mainMenu.classList.remove('hidden');
            audioPlayer.pause();
            audioPlayer.currentTime = 0;
            currentPrayer = null;
            isPlaying = false;
        }

        // --- EVENT LISTENERS ---
        document.querySelectorAll('[data-prayer]').forEach(button => {
            button.addEventListener('click', () => startPrayer(button.dataset.prayer));
        });

        playPauseBtn.addEventListener('click', () => {
            if (isPlaying) {
                audioPlayer.pause();
                isPlaying = false;
                playPauseBtn.textContent = "Devam Et"; // Continue
            } else {
                if (audioPlayer.src && audioPlayer.paused && audioPlayer.currentTime > 0) {
                    audioPlayer.play();
                } else {
                    playCurrentStep();
                }
                isPlaying = true;
                playPauseBtn.textContent = "Duraklat"; // Pause
            }
        });

        stopBtn.addEventListener('click', showMainMenu);

        audioPlayer.addEventListener('ended', () => {
            console.log("Audio beendet, nächster Schritt.");
            goToNextStep();
        });

    </script>
</body>
</html>
